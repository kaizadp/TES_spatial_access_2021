---
title: "drake_md_report"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      collapse = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      comment = "#>",
                      fig.path = ("markdown/fticr2/"))

#source("code/0-packages.R")
library(drake)
```

---

## HYPOTHESES

- C amendments will increase diversity of SOM molecules
- C amendments will cause a depletion of aromatic molecules, especially in fine pores
- Homogenization will increase (a) total peaks, (b) diversity of peaks, (c) aromatic peaks


We selected only peaks seen in >1 of the 4 replicates (i.e. n = 2 or 3 or 4)

---

### setup
how many FTICR reps per treatment type?

<details>
  <summary>click to open</summary>
  
```{r reps, eval=TRUE}
readd(reps) %>% 
   arrange(reps) %>% 
   knitr::kable()
```

**so we select formulae seen in at least 2 reps per treatment type**

</details>


---

## van krevelens  

<details>
  <summary>domains, baseline</summary>

### fticr domains  

```{r domains, fig.height=4, fig.width=6}
readd(gg_fticr_domains)
```

```{r vk_baseline, fig.width=5, fig.height=5}
readd(gg_fticr_baseline)
```

</details>

<details>
  <summary>VK by replication</summary>
  
  
### VK by replication

```{r vk_reps, fig.width=10, fig.height=8}
readd(gg_fticr_reps_1_5_intact)
readd(gg_fticr_reps_50_intact)
readd(gg_fticr_reps_1_5_homo)
readd(gg_fticr_reps_50_homo)
```

</details>


<details>
  <summary>VK by treatment</summary>
  
#### VK diagrams by treatment 
```{r vk_pores, fig.width=10, fig.height=5}
readd(gg_fticr_pores_1_5kPa)
readd(gg_fticr_pores_50kPa)
```

</details>



<details>
  <summary>VK unique</summary>
  
#### VK unique
unique to each amendment, in each incubation type

```{r vk_unique, fig.width=10, fig.height=5}
readd(gg_fticr_unique_int)
readd(gg_fticr_unique_homo)
```

</details>

---

### peaks

<details>
  <summary>graphs</summary>

```{r fticr_peaks_bar, fig.height=8, fig.width=8}
readd(gg_peaks_bar)
```

complex:simple compounds

```{r fticr_peaks_aliph_arom, fig.width = 8}
readd(gg_aliph_aromatic)
```


```{r}
readd(aliphatic_aromatic_counts) %>% 
  filter(Homogenization=="Intact") %>% 
  ggplot(aes(x = Amendments, y = arom_aliph_ratio, color = Moisture, shape = Wetting))+
  geom_boxplot(fill=NA, color = "grey", aes(group=Amendments))+
  geom_point(size=3, position = position_dodge(width = 0.7))+
  facet_grid(Homogenization~Suction)+
  NULL
```

</details>


<details>
  <summary>peak count tables</summary>

tables -- total peaks

```{r}
readd(peakcounts_table_total) %>% 
  knitr::kable()
```

tables -- complex peaks
```{r}
readd(peakcounts_table_aromatic) %>% 
  knitr::kable()
```

</details>


---

### relative abundances

```{r fticr_relabund, fig.height=8, fig.width=8}
readd(gg_fticr_relabund_barplots)
```



### STATS 

<details>
  <summary>PERMANOVA</summary>
  
#### PERMANOVA
**overall**
```{r permanova_overall}
readd(permanova_fticr_all)
```

**PERMANOVA for treatments**

1.5 kPa intact cores
```{r}
readd(permanova_fticr_1_5_intact)
```

50 kPa intact cores
```{r}
readd(permanova_fticr_50_intact)
```

1.5 kPa homogenized cores
```{r}
readd(permanova_fticr_1_5_homo)
```

50 kPa homogenized cores
```{r}
readd(permanova_fticr_50_homo)
```








</details>

#### PCA 

<details>
  <summary>overall PCA</summary>
  
```{r fticr_pca_overall, fig.height=7, fig.width=15}
readd(gg_fticr_pca_intact)
readd(gg_fticr_pca_homo)
```

</details>


<details>
  <summary>PCA individual treatments</summary>
  
**individual cores**

```{r fticr_pca_indiv, fig.height=7, fig.width=15}
readd(gg_fticr_pca_intact_combined)
readd(gg_fticr_pca_homo_combined)
```

</details>


---




### others

<details>
  <summary>other plots</summary>
  
#### NOSC

```{r NOSC, fig.height=8, fig.width=10}
readd(gg_nosc)
```

#### elements
```{r elements}
readd(gg_elements_n)
readd(gg_elements_o)

```

</details>


## Session Info

<details>   
   <summary>click to expand</summary>

Date run: `r Sys.Date()`

```{r}
sessionInfo()
```

</details>   



